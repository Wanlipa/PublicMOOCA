<%- include('includes/head.ejs') %>

  </head>

  <body>
    <%- include('includes/navigation.ejs') %>

      <nav id="navbar-example2" class="navbar navbar-light bg-light">
        <a class="navbar-brand" href="#">
          <h3 class="text-default">
            <i class="fas fa-chart-pie text-default"></i> Course Visualization</h3>
        </a>

        <ul class="nav nav-pills">
          <li class="nav-item">
            <a class="nav-link" href="#cs" title="Course Structure">
              <i class="fas fa-chalkboard-teacher fa-2x text-info"></i>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#le" title="Learners' Engagement">
              <i class="fas fa-user-graduate fa-2x text-success"></i>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#ci" title="Course Information">
              <i class="fas fa-list-ul fa-2x text-light"></i>
            </a>
          </li>
        </ul>
      </nav>
      <div class="container">
        <br>
        <div data-spy="scroll" data-target="#navbar-example2" data-offset="0">

          <h4 id="cs" class="text-info">
            <i class="fas fa-chalkboard-teacher fa-1x text-info"></i> Course Structure</h4>
          <div id="structure"></div>

          <h4 id="le" class="text-success">
            <i class="fas fa-user-graduate fa-1x text-success"></i> Learners' Engagement</h4>
          <div id="learners"></div>
          <br>
          <h4 id="ci" class="text-primary">
            <i class="fas fa-list-ul fa-1x text-primary"></i> Course Information</h4>
          <br>
          <!-- information -->
          <div>
            <!-- Nav tabs -->
            <ul class="nav nav-tabs" id="myTab" role="tablist">
              <li class="nav-item">
                <a class="nav-link active" id="courseinfo-tab" data-toggle="tab" href="#courseinfo" role="tab" aria-controls="courseinfo"
                  aria-selected="true">Course Information</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" id="courselength-tab" data-toggle="tab" href="#courselength" role="tab" aria-controls="courselength"
                  aria-selected="false">Course Length</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" id="bloom-tab" data-toggle="tab" href="#bloom" role="tab" aria-controls="bloom" aria-selected="false">Bloom's Taxonomy</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" id="components-tab" data-toggle="tab" href="#components" role="tab" aria-controls="components" aria-selected="false">Components</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" id="analysis-tab" data-toggle="tab" href="#analysis" role="tab" aria-controls="analysis" aria-selected="false">Analysis</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" id="learner-tab" data-toggle="tab" href="#learner" role="tab" aria-controls="learner" aria-selected="false">Learners</a>
              </li>
            </ul>

            <!-- Tab panes -->
            <div class="tab-content">
              <div class="tab-pane active" id="courseinfo" role="tabpanel" aria-labelledby="courseinfo-tab">
                <ul class="list-group">
                  <li class="list-group-item">
                    <b>Course Number: </b>
                    <%= course.courseNumber %>
                  </li>
                  <li class="list-group-item">
                    <b>Course Name: </b>
                    <%= course.courseName %>
                  </li>
                  <li class="list-group-item">
                    <b>Passing Rate: </b>
                    <%= course.passRate %> %
                  </li>
                  <li class="list-group-item">
                    <b>Subject Area: </b>
                    <%= course.subjectArea %>
                  </li>
                  <li class="list-group-item">
                    <b>Registered Learners: </b>
                    <%= course.registered %>
                  </li>
                  <li class="list-group-item">
                  </li>
                </ul>
              </div>

              <div class="tab-pane" id="courselength" role="tabpanel" aria-labelledby="courselength-tab">
                <ul class="list-group">
                  <li class="list-group-item">
                    <b>Total Hours: </b>
                    <%= course.totalHour %> Hours
                  </li>
                  <li class="list-group-item">
                    <b>Effort: </b>
                    <%= course.effort %> Hours/Week
                  </li>
                  <li class="list-group-item">
                  </li>
                </ul>
              </div>


              <div class="tab-pane" id="bloom" role="tabpanel" aria-labelledby="bloom-tab">
                <ul class="list-group">
                  <li class="list-group-item">
                    <b>remember: </b>
                    <%= course.remember %> %
                  </li>
                  <li class="list-group-item">
                    <b>understand: </b>
                    <%= course.understand %> %
                  </li>
                  <li class="list-group-item">
                    <b>apply: </b>
                    <%= course.apply %> %
                  </li>
                  <li class="list-group-item">
                    <b>analyze: </b>
                    <%= course.analyze %> %
                  </li>
                  <li class="list-group-item">
                    <b>evaluate: </b>
                    <%= course.evaluate %> %
                  </li>
                  <li class="list-group-item">
                    <b>create: </b>
                    <%= course.create %> %
                  </li>
                  <li class="list-group-item">

                </ul>
              </div>
              <div class="tab-pane" id="components" role="tabpanel" aria-labelledby="components-tab">
                <ul class="list-group">
                  <li class="list-group-item">
                    <b>Chapter: </b>
                    <%= course.chapter %> %
                  </li>
                  <li class="list-group-item">
                    <b>Video: </b>
                    <%= course.video %> %
                  </li>
                  <li class="list-group-item">
                    <b>HTML: </b>
                    <%= course.html %> %
                  </li>
                  <li class="list-group-item">
                    <b>Discussion: </b>
                    <%= course.discussion %> %
                  </li>
                  <li class="list-group-item">
                    <b>Problem: </b>
                    <%= course.problem %> %
                  </li>
                  <li class="list-group-item">

                </ul>
              </div>
              <div class="tab-pane" id="analysis" role="tabpanel" aria-labelledby="analysis-tab">
                <ul class="list-group">
                  <li class="list-group-item">
                    <!-- Large modal -->
                    <a class="text-success" data-toggle="modal" data-target=".bd-example-modal-lg">
                      <i class="fas fa-info-circle fa-lg text-success"></i> Cluster Name
                    </a>
                  </li>
                  <li class="list-group-item">
                    <b>Course Length Clustering: </b>
                    <%= course.cLength %>
                  </li>
                  <li class="list-group-item">
                    <b>Course Bloom's Taxonomy Clustering: </b>
                    <%= course.cBloom %>
                  </li>
                  <li class="list-group-item">
                    <b>Number of Conponents Clustering: </b>
                    <%= course.cNumCom %>
                  </li>
                  <li class="list-group-item">
                    <b>Sequence Conponents Clustering: </b>
                    <%= course.cSeqCom %>
                  </li>
                  <li class="list-group-item">
                  </li>
                </ul>

              </div>
              <div class="tab-pane" id="learner" role="tabpanel" aria-labelledby="learner-tab">
                <ul class="list-group">
                  <li class="list-group-item">
                    <b>Passing Learners: </b>
                    <%= course.passLearner %>
                  </li>
                  <li class="list-group-item">
                    <b>Fail Learners: </b>
                    <%= course.failLearner %>
                  </li>

                </ul>
              </div>
            </div>
          </div>

        </div>
        <div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-lg">
            <div class="modal-content">
              <!-- Table Learners -->
              <table class="table">
                <thead style="text-align: center" class=" bg-success text-light">
                  <tr>
                    <th scope="col">Cluster Dimension</th>
                    <th scope="col">Cluster</th>
                    <th scope="col">Cluster Name</th>

                  </tr>
                </thead>
                <tbody style="text-align: center">
                  <tr>
                    <th scope="row" rowspan="3">Course Length</th>
                    <td>C_L1</td>
                    <td>Long Courses</td>
                  </tr>
                  <tr>
                    <td>C_L2</td>
                    <td>Medium Courses</td>
                  </tr>
                  <tr>
                    <td>C_L3</td>
                    <td>Short Courses</td>
                  </tr>
                  <tr>
                    <th scope="row" rowspan="4">Bloom's Taxonomy</th>
                    <td>C_B1</td>
                    <td>Understanding-focus</td>
                  </tr>
                  <tr>
                    <td>C_B2</td>
                    <td>Understanding, Applying, and Analyzing-focus</td>
                  </tr>
                  <tr>
                    <td>C_B3</td>
                    <td>Remembering, Understanding, and Creating-focus</td>
                  </tr>
                  <tr>
                    <td>C_B4</td>
                    <td>Applying-focus</td>
                  </tr>
                  <tr>
                    <th scope="row" rowspan="2">Number of Components</th>
                    <td>C_N1</td>
                    <td>Video-focus</td>
                  </tr>
                  <tr>
                    <td>C_N2</td>
                    <td>Video and HTML-focus</td>
                  </tr>
                  <tr>
                    <th scope="row" rowspan="3">Sequence Components</th>
                    <td>C_S1</td>
                    <td>discussion-chapter and video-video focus</td>
                  </tr>
                  <tr>
                    <td>C_S2</td>
                    <td>chapter-html and problem-chapter focus</td>
                  </tr>
                  <tr>
                    <td>C_S3</td>
                    <td>discussion-html and video-html focus</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

      </div>

      <script>
        var cNumber = "<%=course.courseNumber%>";
        var pathCourse = "../data/CSV/" + cNumber + ".csv";
        // Course Structure
        Plotly.d3.csv(pathCourse, function (err, rows) {
          function unpack(rows, key) {
            return rows.map(function (row) { return row[key]; });
          }

          var chapter = {
            x: unpack(rows, 'chapter_indx'),
            y: unpack(rows, 'chapter_indy'),
            name: 'Chapter',
            text: unpack(rows, 'chapter_name'),
            type: 'scatter',
            mode: 'markers',
            marker: { size: 15, symbol: 'line-ns-open', color: 'DarkGray' }
          };

          var video = {
            x: unpack(rows, 'video_indx'),
            y: unpack(rows, 'video_indy'),
            name: 'video',
            text: unpack(rows, 'video_name'),
            type: 'scatter',
            mode: 'markers',
            marker: { size: 15, symbol: 'circle', color: 'green' }
          };

          var html = {
            x: unpack(rows, 'html_indx'),
            y: unpack(rows, 'html_indy'),
            name: 'html',
            text: unpack(rows, 'html_name'),
            type: 'scatter',
            mode: 'markers',
            marker: { size: 15, symbol: 'triangle-up', color: 'orange' }
          };

          var discussion = {
            x: unpack(rows, 'discussion_indx'),
            y: unpack(rows, 'discussion_indy'),
            name: 'discussion',
            text: unpack(rows, 'discussion_name'),
            type: 'scatter',
            mode: 'markers',
            marker: { size: 15, symbol: 'pentagon', color: 'red' }
          };

          var problem = {
            x: unpack(rows, 'problem_indx'),
            y: unpack(rows, 'problem_indy'),
            name: 'problem',
            text: unpack(rows, 'problem_name'),
            type: 'scatter',
            mode: 'markers',
            marker: { size: 15, symbol: 'diamond-tall', color: 'blue' }
          };

          var data = [chapter, video, html, discussion, problem];

          var layout = {
            xaxis: {
              range: [-5.85, 112.07]
            },
            yaxis: {
              range: [0, 2]
            },
            title: '<%=course.courseName%>'
          };

          Plotly.newPlot('structure', data, layout);
        });

        // Learners
        var pathLearner = "../data/CSV/" + cNumber + "_problemAttempt.csv";
        Plotly.d3.csv(pathLearner, function (err, rows) {
          function unpack(rows, key) {
            return rows.map(function (row) { return row[key]; });
          }
          var learner1 = {
            x: unpack(rows, 'name'),
            y: unpack(rows, 'not attempted'),
            name: 'Not Attempted',
            text: unpack(rows, 'text'),
            type: 'bar',
            marker: { color: 'red' }
          };

          var learner2 = {
            x: unpack(rows, 'name'),
            y: unpack(rows, 'attempted'),
            name: 'Attempted',
            text: unpack(rows, 'text'),
            type: 'bar',
            marker: { color: 'green' }
          };

          var data2 = [learner1, learner2];

          var layout = { barmode: 'stack' };

          Plotly.newPlot('learners', data2, layout);
        });



      </script>


      <%- include('includes/end.ejs') %>